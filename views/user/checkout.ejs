<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Male_Fashion Template">
    <meta name="keywords" content="Male_Fashion, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Sneakerhead</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&display=swap"
    rel="stylesheet">

    <!-- Css Styles -->
    <link rel="stylesheet" href="assets/css/vendor/vendor.min.css">
    <!-- <link rel="stylesheet" href="assets/css/plugins/plugins.min.css"> -->
    <link rel="stylesheet" href="assets/css/style.min.css">

    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="css/elegant-icons.css" type="text/css">
    <link rel="stylesheet" href="css/magnific-popup.css" type="text/css">
    <link rel="stylesheet" href="css/nice-select.css" type="text/css">
    <link rel="stylesheet" href="css/owl.carousel.min.css" type="text/css">
    <link rel="stylesheet" href="css/slicknav.min.css" type="text/css">
    <link rel="stylesheet" href="css/style.css" type="text/css">
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <style>
        .custom-black-background {
    background-color: black;
    color: white; /* Optionally, set text color to contrast with the black background */
}

    </style>
</head>

<body>
    <!-- Page Preloder -->
    <div id="preloder">
        <div class="loader"></div>
    </div>

    <!-- Offcanvas Menu Begin -->
    <div class="offcanvas-menu-overlay"></div>
    <div class="offcanvas-menu-wrapper">
        <div class="offcanvas__option">
            <div class="offcanvas__links">
                <% if (typeof user !== 'undefined') { %>
                    <a href="/user/profile">Profile</a>
                    <a href="/user/logout">Logout</a>
                <% } else { %>
                    <a href="/user/login">Sign in</a>
                   
                <% } %> 
            </div>
            <div class="offcanvas__top__hover">
                <span>Usd <i class="arrow_carrot-down"></i></span>
                <ul>
                    <li>USD</li>
                    <li>EUR</li>
                    <li>USD</li>
                </ul>
            </div>
        </div>
        <div class="offcanvas__nav__option">
            <a href="#" class="search-switch"><img src="img/icon/search.png" alt=""></a>
            <a href="#"><img src="img/icon/heart.png" alt=""></a>
            <a href="#"><img src="img/icon/cart.png" alt=""> <span>0</span></a>
            <div class="price"> </div>
        </div>
        <div id="mobile-menu-wrap"></div>
        <div class="offcanvas__text">
            <p>Free shipping, 30-day return or refund guarantee.</p>
        </div>
    </div>
    <!-- Offcanvas Menu End -->

    <!-- Header Section Begin -->
    <header class="header">
        <div class="header__top">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-md-7">
                        <div class="header__top__left">
                            <p>Free shipping, 30-day return or refund guarantee.</p>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-5">
                        <div class="header__top__right">
                            <div class="header__top__links">
                                <% if (typeof user !== 'undefined') { %>
                                    <a href="/user/profile">Profile</a>
                                    <a href="/user/logout">logout</a>
                                <% } else { %>
                                    <a href="/user/login">Sign in</a>
                                    <a href="#">FAQs</a>
                                <% } %>
                            </div>
                            <div class="header__top__hover">
                                <span>Usd <i class="arrow_carrot-down"></i></span>
                                <ul>
                                    <li>USD</li>
                                    <li>EUR</li>
                                    <li>USD</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-3">
                    <div class="header__logo">
                        <a href="/user/index"><img src="img/logo2.png" alt=""></a>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6">
                    <nav class="header__menu mobile-menu">
                        <ul>
                            <li class="active"><a href="/user/index">Home</a></li>
                            <li><a href="/user/shop">Shop</a></li>
                            
                            
                            <li><a href="/user/contact">Contacts</a></li>
                        </ul>
                    </nav>
                </div>
                <div class="col-lg-3 col-md-3">
                    <div class="header__nav__option">
                        <a href="#" class="search-switch"><img src="img/icon/search.png" alt=""></a>
                        <a href="/user/wishlist"><img src="img/icon/heart.png" alt=""></a>
                        <a href="/user/cart"><img src="img/icon/cart.png" alt=""> <span>0</span></a>
                        <div class="price"> </div>
                    </div>
                </div>
            </div>
            <div class="canvas__open"><i class="fa fa-bars"></i></div>
        </div>
    </header>
    <!-- Header Section End -->

    <!-- Breadcrumb Section Begin -->
    <section class="breadcrumb-option">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb__text">
                        <h4>Check Out</h4>
                        <div class="breadcrumb__links">
                            <a href="/user/index">Home</a>
                            <a href="/user/shop">Shop</a>
                            <span>Check Out</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb Section End -->

    <!-- Checkout Section Begin -->
    <section class="checkout spad">
        <div class="checkout-section">
            <form action="" method="post">
            <div class="container">
                <!-- Start User Details Checkout Form -->
                <div class="checkout_form" data-aos="fade-up" data-aos-delay="400">
                    <div class="row">
                        <div class="col-lg-6 col-md-6">
                            <!-- <h5 class="billing-address">Address</h5> -->
                                <h3 class="card-title"><%=user.name%></h3>
                                <%if(address!== null){
                                    for (let i = 0; i < address.addresses.length; i++) {
                                        
                                        
                                    %>
                                   
                                    <div class="card mb-2">
                                        <div class="card-body" style="display: flex; align-items: center;">
                                            <div class="address-radio" style="margin-right: 10px;">
                                                <input type="radio" name="address" value="<%=address.addresses[i].addressType %>" id="address<%= i %>" style="margin-top: 6px;" />
                                                <label for="address<%= i %>"></label>
                                            </div>
                                            <div class="address-details">
                                                <p class="card-text">
                                                    <%= address.addresses[i].HouseNo %> ,
                                                    <%= address.addresses[i].Landmark %> ,
                                                    <%= address.addresses[i].Street %> ,
                                                    <%= address.addresses[i].city %> ,
                                                    <%= address.addresses[i].district %> ,
                                                    <%= address.addresses[i].Country %>,
                                                    Pincode-<%= address.addresses[i].pincode %>
                                                </p>
                                                <a href="/user/editaddress?addressType=<%= address.addresses[i].addressType %>" class="btn btn-md btn-black-default-hover custom-black-background">Edit</a>
                                                <a href="/user/deleteaddress?addressType=<%= address.addresses[i].addressType %>" class="btn btn-md btn-black-default-hover custom-black-background">Remove</a>
                                            </div>
                                        </div>
                                    </div>
                                  <%}}else{%>
                                    <p>Please Add address</p>
                                    <%}%><br>
                                    <a href="/user/addaddress" class="btn btn-md btn-black-default-hover custom-black-background">Add Address</a>
                        </div>
                        <div class="col-lg-6 col-md-6">
                            
                                <h3>Your order</h3>
                                <div class="order_table table-responsive">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Product</th>
                                                <th>Total</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                               <% for(let i=0;i<cart.items.length;i++){ %>
                                            <tr>
                                                <td class="product_name"><a href="/user/productdetails?id=<%=cart.items[i].productId._id %>" style="color: red;"><%=cart.items[i].productId.name%></a></td>

                                                <td class="product_total" id="carttotal">Rs.<%=Math.floor(cart.items[i].price)%></td>
                                                
                                            </tr>
                                                <%}%>
                                        </tbody>
                                            <tr class="order_total">
                                                <th>Order Total</th>
                                                <td name="billTotal"><strong>Rs.<%=Math.floor(cart.billTotal)%></strong></td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                                <div class="payment_method">
    <% if(cart.billTotal<10000) {%>
    <div class="panel-default">
        <label class="checkbox-default" for="currencyCod" data-bs-toggle="collapse" data-bs-target="#methodCod" aria-controls="methodCod">
            <input type="radio" id="currencyCod" value="COD" name="paymentOption">
            <span>Cash on Delivery</span>
        </label>
        <div id="methodCod" class="collapse" data-parent=".payment_method">
            <div class="card-body1">
                <p>Please send a check to Store Name, Store Street, Store Town, Store State / County, Store Postcode.</p>
            </div>
        </div>
    </div>
    <div class="panel-default">
        <label class="checkbox-default" for="currencyPaypal" data-bs-toggle="collapse" data-bs-target="#methodPaypal" aria-controls="methodPaypal">
            <input type="radio" id="currencyPaypal" value="razorpay" name="paymentOption">
            <span>Online Paymnet</span>
        </label>
        <div id="methodPaypal" class="collapse" data-parent=".payment_method">
            <div class="card-body1">
                <p>Pay via Razorpay;</p>
            </div>
        </div>
    </div>

    <div class="panel-default">
    <label class="checkbox-default" for="currencyWallet" data-bs-toggle="collapse" data-bs-target="#methodWallet" aria-controls="methodWallet">
        <input type="radio" id="currencyWallet" value="wallet" name="paymentOption">
        <span>Wallet Payment</span>
    </label>
    <div id="methodWallet" class="collapse" data-parent=".payment_method">
        <div class="card-body1">
            <p>Pay via Wallet;</p>
        </div>
    </div>
</div>


    <%} else {%> 
    <div class="panel-default">
        <label class="checkbox-default" for="currencyPaypal" data-bs-toggle="collapse" data-bs-target="#methodPaypal" aria-controls="methodPaypal">
            <input type="radio" id="currencyPaypal" value="razorpay" name="paymentOption">
            <span>Online Payment</span>
            <input type="radio" id="currencyPaypal" value="razorpay" name="paymentOption" disabled>
            
            <span>Cash on Delivery (Not Available)</span>
        </label>
        <div id="methodPaypal" class="collapse" data-parent=".payment_method">
            <div class="card-body1">
                <p>Pay via Razorpay;</p>
            </div>
        </div>
    </div>

    <div class="panel-default">
    <label class="checkbox-default" for="currencyWallet" data-bs-toggle="collapse" data-bs-target="#methodWallet" aria-controls="methodWallet">
        <input type="radio" id="currencyWallet" value="wallet" name="paymentOption">
        <span>Wallet Payment</span>
    </label>
    <div id="methodWallet" class="collapse" data-parent=".payment_method">
        <div class="card-body1">
            <p>Pay via Wallet;</p>
        </div>
    </div>
</div>

    <%}%>
    <div class="order_button pt-3">
        <button class="btn btn-md btn-black-default-hover custom-black-background" id="proceedButton" type="submit">Place Order</button>
    </div>
</div>

                                
                                
                            </form>
                        </div>
                    </div>
                </div> <!-- Start User Details Checkout Form -->
            </div>
        </div><!-- ...:::: End Checkout Section:::... -->
    </section>
    <!-- Checkout Section End -->

    <!-- Footer Section Begin -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="footer__about">
                        <div class="footer__logo">
                            <a href="#"><img src="img/logo2.png" alt=""></a>
                        </div>
                        <p>The customer is at the heart of our unique business model, which includes design.</p>
                        <a href="#"><img src="img/payment.png" alt=""></a>
                    </div>
                </div>
                <div class="col-lg-2 offset-lg-1 col-md-3 col-sm-6">
                    <div class="footer__widget">
                        <h6>Shopping</h6>
                        <ul>
                            <li><a href="#">Clothing Store</a></li>
                            <li><a href="#">Trending Shoes</a></li>
                            <li><a href="#">Accessories</a></li>
                            <li><a href="#">Sale</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6">
                    <div class="footer__widget">
                        <h6>Shopping</h6>
                        <ul>
                            <li><a href="#">Contact Us</a></li>
                            <li><a href="#">Payment Methods</a></li>
                            <li><a href="#">Delivary</a></li>
                            <li><a href="#">Return & Exchanges</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-3 offset-lg-1 col-md-6 col-sm-6">
                    <div class="footer__widget">
                        <h6>NewLetter</h6>
                        <div class="footer__newslatter">
                            <p>Be the first to know about new arrivals, look books, sales & promos!</p>
                            <form action="#">
                                <input type="text" placeholder="Your email">
                                <button type="submit"><span class="icon_mail_alt"></span></button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 text-center">
                    <div class="footer__copyright__text">
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        <p>Copyright ©
                            <script>
                                document.write(new Date().getFullYear());
                            </script>2020
                            All rights reserved | This template is made with <i class="fa fa-heart-o"
                            aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
                        </p>
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Section End -->
    <!-- Start Modal Add cart -->
    <div class="modal fade" id="modalAddcart" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog  modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col text-right">
                                <button type="button" class="close modal-close" data-bs-dismiss="modal"
                                    aria-label="Close">
                                    <span aria-hidden="true"> <i class="fa fa-times"></i></span>
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-7">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="modal-add-cart-product-img">
                                            <img class="img-fluid"
                                                src="assets/images/product/default/home-1/default-1.jpg" alt="">
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="modal-add-cart-info"><i class="fa fa-check-square"></i>Added to cart
                                            successfully!</div>
                                        <div class="modal-add-cart-product-cart-buttons">
                                            <a href="cart.html">View Cart</a>
                                            <a href="checkout.html">Checkout</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-5 modal-border">
                                <ul class="modal-add-cart-product-shipping-info">
                                    <li> <strong><i class="icon-shopping-cart"></i> There Are 5 Items In Your
                                            Cart.</strong></li>
                                    <li> <strong>TOTAL PRICE: </strong> <span>$187.00</span></li>
                                    <li class="modal-continue-button"><a href="#" data-bs-dismiss="modal">CONTINUE
                                            SHOPPING</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- End Modal Add cart -->

    <!-- Start Modal Quickview cart -->
    <div class="modal fade" id="modalQuickview" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col text-right">
                                <button type="button" class="close modal-close" data-bs-dismiss="modal"
                                    aria-label="Close">
                                    <span aria-hidden="true"> <i class="fa fa-times"></i></span>
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="product-details-gallery-area mb-7">
                                    <!-- Start Large Image -->
                                    <div class="product-large-image modal-product-image-large swiper-container">
                                        <div class="swiper-wrapper">
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-1.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-2.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-3.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-4.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-5.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-6.jpg" alt="">
                                            </div>
                                        </div>
                                    </div>
                                    <!-- End Large Image -->
                                    <!-- Start Thumbnail Image -->
                                    <div
                                        class="product-image-thumb modal-product-image-thumb swiper-container pos-relative mt-5">
                                        <div class="swiper-wrapper">
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-1.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-2.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-3.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-4.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-5.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-6.jpg" alt="">
                                            </div>
                                        </div>
                                        <!-- Add Arrows -->
                                        <div class="gallery-thumb-arrow swiper-button-next"></div>
                                        <div class="gallery-thumb-arrow swiper-button-prev"></div>
                                    </div>
                                    <!-- End Thumbnail Image -->
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="modal-product-details-content-area">
                                    <!-- Start  Product Details Text Area-->
                                    <div class="product-details-text">
                                        <h4 class="title">Nonstick Dishwasher PFOA</h4>
                                        <div class="price"><del>$70.00</del>$80.00</div>
                                    </div> <!-- End  Product Details Text Area-->
                                    <!-- Start Product Variable Area -->
                                    <div class="product-details-variable">
                                        <!-- Product Variable Single Item -->
                                        <div class="variable-single-item">
                                            <span>Color</span>
                                            <div class="product-variable-color">
                                                <label for="modal-product-color-red">
                                                    <input name="modal-product-color" id="modal-product-color-red"
                                                        class="color-select" type="radio" checked>
                                                    <span class="product-color-red"></span>
                                                </label>
                                                <label for="modal-product-color-tomato">
                                                    <input name="modal-product-color" id="modal-product-color-tomato"
                                                        class="color-select" type="radio">
                                                    <span class="product-color-tomato"></span>
                                                </label>
                                                <label for="modal-product-color-green">
                                                    <input name="modal-product-color" id="modal-product-color-green"
                                                        class="color-select" type="radio">
                                                    <span class="product-color-green"></span>
                                                </label>
                                                <label for="modal-product-color-light-green">
                                                    <input name="modal-product-color"
                                                        id="modal-product-color-light-green" class="color-select"
                                                        type="radio">
                                                    <span class="product-color-light-green"></span>
                                                </label>
                                                <label for="modal-product-color-blue">
                                                    <input name="modal-product-color" id="modal-product-color-blue"
                                                        class="color-select" type="radio">
                                                    <span class="product-color-blue"></span>
                                                </label>
                                                <label for="modal-product-color-light-blue">
                                                    <input name="modal-product-color"
                                                        id="modal-product-color-light-blue" class="color-select"
                                                        type="radio">
                                                    <span class="product-color-light-blue"></span>
                                                </label>
                                            </div>
                                        </div>
                                        <!-- Product Variable Single Item -->
                                        <div class="d-flex align-items-center flex-wrap">
                                            <div class="variable-single-item ">
                                                <span>Quantity</span>
                                                <div class="product-variable-quantity">
                                                    <input min="1" max="100" value="1" type="number">
                                                </div>
                                            </div>

                                            <div class="product-add-to-cart-btn">
                                                <a href="#" data-bs-toggle="modal" data-bs-target="#modalAddcart">Add To
                                                    Cart</a>
                                            </div>
                                        </div>
                                    </div> <!-- End Product Variable Area -->
                                    <div class="modal-product-about-text">
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Mollitia iste
                                            laborum ad impedit pariatur esse optio tempora sint ullam autem deleniti nam
                                            in quos qui nemo ipsum numquam, reiciendis maiores quidem aperiam, rerum vel
                                            recusandae</p>
                                    </div>
                                    <!-- Start  Product Details Social Area-->
                                    <div class="modal-product-details-social">
                                        <span class="title">SHARE THIS PRODUCT</span>
                                        <ul>
                                            <li><a href="#" class="facebook"><i class="fa fa-facebook"></i></a></li>
                                            <li><a href="#" class="twitter"><i class="fa fa-twitter"></i></a></li>
                                            <li><a href="#" class="pinterest"><i class="fa fa-pinterest"></i></a></li>
                                            <li><a href="#" class="google-plus"><i class="fa fa-google-plus"></i></a>
                                            </li>
                                            <li><a href="#" class="linkedin"><i class="fa fa-linkedin"></i></a></li>
                                        </ul>

                                    </div> <!-- End  Product Details Social Area-->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- End Modal Quickview cart -->
    <!-- Search Begin -->
    <div class="search-model">
        <div class="h-100 d-flex align-items-center justify-content-center">
            <div class="search-close-switch">+</div>
            <form class="search-model-form">
                <input type="text" id="search-input" placeholder="Search here.....">
            </form>
        </div>
    </div>
    <!-- Search End -->

    
    <script>
document.getElementById('proceedButton').addEventListener("click", async (e) => {
    e.preventDefault(); // Prevent form from submitting traditionally
   
    const selectedAddressType = document.querySelector('input[name="address"]:checked');
    const selectedPaymentOption = document.querySelector('input[name="paymentOption"]:checked');

    if (!selectedAddressType || !selectedPaymentOption) {
        Swal.fire({
            title: 'Attention!',
            text: 'Please select both an address and a payment option.',
            icon: 'warning',
            confirmButtonText: 'OK'
        });
        return;
    }

    const addressType = selectedAddressType.value;
    const paymentOption = selectedPaymentOption.value;
    

    const data = { addressType, paymentOption };
    console.log(data)
    try {
        let response;
        if (paymentOption === 'COD') {
            response = await fetch('/user/checkout', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                const responseData = await response.json();
                Swal.fire({
                    title: 'Success!',
                    text: 'Order placed successfully.',
                    icon: 'success',
                    confirmButtonText: 'OK'
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = `/user/orderconfirmed?id=${responseData.order_id}`;
                    }
                });
            } else {
                const errorData = await response.json();
                Swal.fire({
                    title: 'Error!',
                    text: errorData.message || 'An error occurred during order placement.',
                    icon: 'error',
                    confirmButtonText: 'OK'
                });
            }
        } else if (paymentOption === "wallet") {
            console.log("hasda")
            response = await fetch('/user/checkout', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                const responseData = await response.json();
                Swal.fire({
                    title: 'Success!',
                    text: 'Order placed successfully using wallet',
                    icon: 'success',
                    confirmButtonText: 'OK'
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = `/user/orderconfirmed?id=${responseData.order_id}`;
                    }
                });
            } else {
                const errorData = await response.json();
                Swal.fire({
                    title: 'Error!',
                    text: errorData.message || 'An error occurred during order placement.',
                    icon: 'error',
                    confirmButtonText: 'OK'
                });
            }
        } else if (paymentOption === 'razorpay') {
            response = await fetch('/user/createOrder', {
                method: "POST",
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                const res = await response.json();
                console.log(res,"response----------")
                if (res.success) {
                    const options = {
                        "key": "rzp_test_OvlqTLx9YhJjvs", 
                        "amount": res.amount,
                        "currency": "INR",
                        "name": "Sneakerhead",
                        "description": "Find your shoes here!",
                        "image": "http://localhost:3000/user/img/logo2.png",
                        "order_id": res.order_id,
                        "handler": async function (response) {
                            const data1 = {data,response}
                            console.log(response,"resposnee fail or succ");
                            
                            const serverResponse = await fetch('/user/checkout/',{
                                method:"POST",
                                headers:{
                                    "Content-Type":"application/json"
                                },
                                body:JSON.stringify(data1)
                            }) 
                            if(serverResponse.ok){
                                const responseData= await serverResponse.json()

                                Swal.fire({
                                    title:"Succes",
                                    text:"Order placed successfully",
                                    icon:"success",
                                    confirmButtonText:"OK"
                                }).then((result)=>{
                                    if(result.isConfirmed){
                                        window.location.href=  `/user/orderconfirmed?id=${responseData.order_id}`
                                    }
                                })
                            }

                        },
                        "prefill": {
                            "contact": res.contact,
                            "name": res.name,
                            "email": res.email
                        },
                        "notes": {
                            "description": res.description
                        },
                        "theme": {
                            "color": "#2300a3"
                        }
                    };
                    const razorpayObject = new Razorpay(options);
                    console.log(razorpayObject)
                    razorpayObject.on('payment.failed', function (response) {
                       
                        console.log(response)
                        Swal.fire({
                            title: 'Payment Failed',
                            text: response.error.description || 'An error occurred during payment.',
                            icon: 'error',
                            confirmButtonText: 'OK'
                        }).then( async (error)=>{
    
                            const data2 ={error,data}
                            console.log(data2)
                            const failRes = await fetch ('/user/checkout',{
                                method:'POST',
                                headers:{
                                    "Content-Type":"application/json"
                                },
                                body:JSON.stringify(data2)
                            })
                            if (failRes.ok) {
                const responseData = await failRes.json();
                Swal.fire({
                    title: 'Success!',
                    text: 'Order placed Payment pending.',
                    icon: 'success',
                    confirmButtonText: 'OK'
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = `/user/orderconfirmed?id=${responseData.order_id}`;
                    }
                });
            } else {
                const errorData = await failRes.json();
                Swal.fire({
                    title: 'Error!',
                    text: errorData.message || 'An error occurred during order placement.',
                    icon: 'error',
                    confirmButtonText: 'OK'
                });
            }
                        });
                    });
                    razorpayObject.open();
                } else {
                    Swal.fire({
                        title: 'Error!',
                        text: res.msg || 'An error occurred during order creation.',
                        icon: 'error',
                        confirmButtonText: 'OK'
                    });
                }
            } else {
                const errorData = await response.json();
                Swal.fire({
                    title: 'Error!',
                    text: errorData.msg || 'An error occurred during order creation.',
                    icon: 'error',
                    confirmButtonText: 'OK'
                });
            }
        }
    } catch (error) {
        console.error('Error:', error);
        Swal.fire({
            title: 'Error!',
            text: 'An error occurred during order placement. Please try again.',
            icon: 'error',
            confirmButtonText: 'OK'
        });
    }
});
</script>


    <script src="assets/js/vendor/vendor.min.js"></script>
    <script src="assets/js/plugins/plugins.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Js Plugins -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <script src="js/jquery.nicescroll.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/jquery.countdown.min.js"></script>
    <script src="js/jquery.slicknav.js"></script>
    <script src="js/mixitup.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>

</body>
</html>